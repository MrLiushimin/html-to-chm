<!DOCTYPE html>

<html class="translated-ltr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Nagios的</title>
<link rel="stylesheet" type="text/css" href="../C.css">
<script type="text/javascript" src="../jquery.js"></script><script type="text/javascript" src="../jquery.syntax.js"></script><script type="text/javascript" src="../yelp.js"></script>
<link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css"></head>
<body id="home">
<!--<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><script>
      function englishPageVersion() {
        var href = window.location.href;
        if (href.slice(-1) == "/") {
                window.location = "index.html.en";
        } else {
                window.location = href.replace(/\.html.*/, ".html.en");
        }
         return false;
      }
      function browserPreferredLanguage() {
        var href = window.location.href;
        if (href.slice(-1) == "/") {
                window.location = href;
        } else {
                window.location = href.replace(/\.html.*/, ".html");
        }
        return false;
      }
      </script>--><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="https://partners.ubuntu.com"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伙伴</font></font></a></li>
<li><a href="https://www.ubuntu.com/support/community-support"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></a></li>
<li><a href="https://community.ubuntu.com"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区</font></font></a></li>
<li><a href="https://www.ubuntu.com"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu.com</font></font></a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu文档</font></font></a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="https://help.ubuntu.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">官方文件</font></font></a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区帮助Wiki</font></font></a></li>
<li><a href="https://community.ubuntu.com/t/contribute/26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有助于</font></font></a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript><!--
<script>
                document.write('<form action="https://help.ubuntu.com/search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>-->
</div></div>
<div class="trails"><div class="trail">
<a href="https://help.ubuntu.com/18.04" class="trail"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu 18.04</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;» </font></font><a class="trail" href="../index.html" title="Ubuntu服务器指南"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu服务器指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;» </font></font><a class="trail" href="monitoring.html" title="监控"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">监控</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;»</font></font></div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="monitoring-overview.html" title="概观"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a><a class="nextlinks-next" href="munin.html" title="穆宁"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一页</font></font></a>
</div>
<div class="hgroup"><h1 class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios的</font></font></h1></div>
<div class="region">
<div class="contents"></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="nagios.html#nagios-installation" title="安装"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></a></li>
<li class="links"><a class="xref" href="nagios.html#nagios-configuration-overview" title="配置概述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置概述</font></font></a></li>
<li class="links"><a class="xref" href="nagios.html#nagios-configuration" title="组态"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组态</font></font></a></li>
<li class="links"><a class="xref" href="nagios.html#nagios-references" title="参考"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考</font></font></a></li>
</ul></div>
<div class="sect2 sect" id="nagios-installation"><div class="inner">
<div class="hgroup"><h2 class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></h2></div>
<div class="region"><div class="contents">
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      首先，在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server01上</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包。</font><font style="vertical-align: inherit;">在终端输入：
      </font></font></p>
<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo apt install nagios3 nagios-nrpe-plugin</font></font></span>
</pre></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      系统将要求您输入</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagiosadmin</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font><font style="vertical-align: inherit;">的密码</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">用户的凭据存储在</font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios3/htpasswd.users中</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要更改</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagiosadmin</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码或将其他用户添加到Nagios CGI脚本，请使用</font><font style="vertical-align: inherit;">属于 
       </font><span class="app application"><font style="vertical-align: inherit;">apache2-utils</font></span><font style="vertical-align: inherit;">软件包</font><font style="vertical-align: inherit;">的</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">htpasswd</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font><span class="app application"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例如，要更改</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagiosadmin</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font><font style="vertical-align: inherit;">的密码，</font><span class="em emphasis"><font style="vertical-align: inherit;">请</font></span><font style="vertical-align: inherit;">输入：
      </font></font></p>
<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo htpasswd /etc/nagios3/htpasswd.users nagiosadmin</font></font></span>
</pre></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要添加用户：
      </font></font></p>
<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo htpasswd /etc/nagios3/htpasswd.users steve</font></font></span>
</pre></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      接下来，在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server02上</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios-nrpe-server</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件包。</font><font style="vertical-align: inherit;">从server02上的终端输入：
      </font></font></p>
<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo apt安装nagios-nrpe-server</font></font></span>
</pre></div>
<div class="note" title="注意"><div class="inner"><div class="region"><div class="contents">
        <p class="para">
        <span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NRPE</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您在远程主机上执行本地检查。</font><font style="vertical-align: inherit;">还有其他方法可以通过其他Nagios插件以及其他检查来实现此目的。  
        </font></font></p>
      </div></div></div></div>
</div></div>
</div></div>
<div class="sect2 sect" id="nagios-configuration-overview"><div class="inner">
<div class="hgroup"><h2 class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置概述</font></font></h2></div>
<div class="region"><div class="contents">
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有几个包含</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置和检查文件的目录。
      </font></font></p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para">
          <span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / nagios3</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含用于</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          守护程序，CGI文件，主机等</font><font style="vertical-align: inherit;">操作的配置文件</font><font style="vertical-align: inherit;">。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / nagios-plugins</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含服务检查的配置文件。 
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在远程主机上包含</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios-nrpe-server</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置文件。 
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / lib / nagios / plugins /</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：存储检查二进制文件的位置。</font><font style="vertical-align: inherit;">要查看检查选项，请使用
           </font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-h</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。  
          </font></font></p>
          
          <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   
          例如：</font></font><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / lib / nagios / plugins / check_dhcp -h</font></font></span>
          </p>
        </li>
</ul></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有很多检查</font><font style="vertical-align: inherit;">可以配置</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来执行任何给定的主机。</font><font style="vertical-align: inherit;">对于此示例，Nagios将配置为检查磁盘空间，DNS和MySQL主机组。</font><font style="vertical-align: inherit;">DNS检查将在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server02上</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL </font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机组</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将包括</font><span class="em emphasis"><font style="vertical-align: inherit;">server01</font></span><font style="vertical-align: inherit;">和</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server02</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p>
<div class="note" title="注意"><div class="inner"><div class="region"><div class="contents">
        <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关</font><font style="vertical-align: inherit;">设置Apache，</font><a class="xref" href="dns.html" title="域名服务（DNS）"><font style="vertical-align: inherit;">DNS的域名服务（DNS）</font></a><font style="vertical-align: inherit;">和</font><a class="xref" href="mysql.html" title="MySQL的"><font style="vertical-align: inherit;">MySQL</font></a><font style="vertical-align: inherit;">的MySQL的</font><font style="vertical-align: inherit;">详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="httpd.html" title="HTTPD  -  Apache2 Web服务器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPD  -  Apache2 Web服务器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font><a class="xref" href="dns.html" title="域名服务（DNS）"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a class="xref" href="mysql.html" title="MySQL的"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
      </div></div></div></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      此外，有些术语一旦解释，有望更容易理解Nagios配置：
      </font></font></p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para">
          <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：正在监控的服务器，工作站，网络设备等。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机组</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：一组类似的主机。</font><font style="vertical-align: inherit;">例如，您可以对所有Web服务器，文件服务器等进行分组。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：主机上正在监控的服务。</font><font style="vertical-align: inherit;">如HTTP，DNS，NFS等
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务组</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：允许您将多个服务组合在一起。</font><font style="vertical-align: inherit;">例如，这对于分组多个HTTP非常有用。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">联系方式</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：发生事件时收到通知的人员。</font><font style="vertical-align: inherit;">Nagios可以配置为发送电子邮件，短信等。
          </font></font></p>
        </li>
</ul></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      默认情况下，Nagios配置为检查</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地主机</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的HTTP，磁盘空间，SSH，当前用户，进程和负载</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Nagios的也会</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ping命令</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网关</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      大型Nagios安装可能非常复杂。</font><font style="vertical-align: inherit;">通常最好从小型，一个或两个主机启动，按照您喜欢的方式配置，然后展开。
      </font></font></p>
</div></div>
</div></div>
<div class="sect2 sect" id="nagios-configuration"><div class="inner">
<div class="hgroup"><h2 class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组态</font></font></h2></div>
<div class="region"><div class="contents">
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">

          <div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
              <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              首先，</font><font style="vertical-align: inherit;">为</font><span class="em emphasis"><font style="vertical-align: inherit;">server02</font></span><font style="vertical-align: inherit;">创建</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置文件</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">除非另行指定，否则在</font><span class="em emphasis"><font style="vertical-align: inherit;">server01</font></span><font style="vertical-align: inherit;">上运行所有这些命令</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在终端输入：
             </font></font><span class="em emphasis"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="em emphasis"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo cp /etc/nagios3/conf.d/localhost_nagios2.cfg \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/etc/nagios3/conf.d/server02.cfg</font></font></span>
</pre></div>

             <div class="note" title="注意"><div class="inner"><div class="region"><div class="contents">
               <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               在上面和下面的命令示例中，将</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“server01”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“server02” </font></font></span>
               <span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.18.100.100</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.18.100.101</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换为服务器的主机名和IP地址。
               </font></font></p>
             </div></div></div></div>
             
           </li>
<li class="steps">
             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             接下来，编辑</font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios3/conf.d/server02.cfg</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义主机{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用generic-host; </font><font style="vertical-align: inherit;">要使用的主机模板的名称</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        host_name server02</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        别名Server 02</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        地址172.18.100.101</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃检查DNS服务。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定义服务{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用通用服务</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        host_name server02</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        service_description DNS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        check_command check_dns！172.18.100.101</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             重新启动</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">守护程序以启用新配置：
             </font></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo systemctl restart nagio3.service</font></font></span>
</pre></div>
           
           </li>
</ol></div></div>
       </li>
<li class="list itemizedlist">
         <div class="steps"><div class="inner"><ol class="steps">
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             现在通过将以下内容添加到</font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios3/conf.d/services_nagios2.cfg</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来为MySQL检查添加服务定义</font><font style="vertical-align: inherit;">：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃检查MySQL服务器。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定义服务{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        hostgroup_name mysql-servers</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        service_description MySQL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        check_command check_mysql_cmdlinecred！nagios！secret！$ HOSTADDRESS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用通用服务</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        notification_interval 0; </font><font style="vertical-align: inherit;">如果要重新通知，则设置&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             一个</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的的服务器</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机组现在需要进行定义。</font><font style="vertical-align: inherit;">编辑 
              </font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios3/conf.d/hostgroups_nagios2.cfg</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#MySQL主机组。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定义主机组{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        hostgroup_name mysql-servers</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                别名MySQL服务器</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                成员localhost，server02</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font>
</pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             Nagios检查需要对MySQL进行身份验证。</font><font style="vertical-align: inherit;">要向</font><font style="vertical-align: inherit;">MySQL </font><font style="vertical-align: inherit;">添加</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户，请输入：
             </font></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql -u root -p -e“创建由'secret'标识的用户nagios;”</font></font></span>
</pre></div>

             <div class="note" title="注意"><div class="inner"><div class="region"><div class="contents">
               <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios的</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户将需要添加的所有主机</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的MySQL的服务器</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机组。
               </font></font></p>
             </div></div></div></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             重启</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以开始检查MySQL服务器。
             </font></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo systemctl restart nagios3.service</font></font></span>
</pre></div>

           </li>
</ol></div></div>
       </li>
<li class="list itemizedlist">
         <div class="steps"><div class="inner"><ol class="steps">
<li class="steps">  

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             最后配置NRPE以检查</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server02</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的磁盘空间</font><font style="vertical-align: inherit;">。
             </font></font></p>
 
             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server01上将</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务检查添加到</font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios3/conf.d/server02.cfg</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#NRPE磁盘检查。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定义服务{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用通用服务</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        host_name server02</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        service_description nrpe-disk</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        check_command check_nrpe_1arg！check_all_disks！172.18.100.101</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             现在在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server02上</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编辑</font></font><span class="file filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/nagios/nrpe.cfg</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allowed_hosts = 172.18.100.100
</font></font></pre></div>

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             在命令定义区域下面添加：
             </font></font></p>

<div class="code"><pre class="contents "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">command [check_all_disks] = / usr / lib / nagios / plugins / check_disk -w 20％-c 10％-e
</font></font></pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             最后，重启</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios-nrpe-server</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo systemctl restart nagios-nrpe-server.service</font></font></span>
</pre></div>

           </li>
<li class="steps">

             <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             另外，在</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server01上</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重启</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font></p>

<div class="screen"><pre class="contents "><span class="cmd command"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo systemctl restart nagios3.service</font></font></span>
</pre></div>

           </li>
</ol></div></div>
       </li>
</ul></div>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您现在应该能够在Nagios CGI文件中看到主机和服务检查。</font><font style="vertical-align: inherit;">要访问它们，请将浏览器指向http：// server01 / nagios3。</font><font style="vertical-align: inherit;">然后，系统将提示您输入</font></font><span class="em emphasis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nagiosadmin</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户名和密码。
      </font></font></p>
</div></div>
</div></div>
<div class="sect2 sect" id="nagios-references"><div class="inner">
<div class="hgroup"><h2 class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考</font></font></h2></div>
<div class="region"><div class="contents">
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节刚刚介绍了Nagios的功能。</font><font style="vertical-align: inherit;">在</font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios的-插件-额外</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和 
       </font></font><span class="app application"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios的-SNMP的插件</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含更多的服务检查。
      </font></font></p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请</font><font style="vertical-align: inherit;">访问</font></font><a href="http://www.nagios.org/" class="ulink" title="http://www.nagios.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          特别是</font></font><a href="http://nagios.sourceforge.net/docs/3_0/" class="ulink" title="http://nagios.sourceforge.net/docs/3_0/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在线文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">站点。
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          还有</font><font style="vertical-align: inherit;">与Nagios和网络监控相关</font><font style="vertical-align: inherit;">的</font></font><a href="http://www.nagios.org/propaganda/books/" class="ulink" title="http://www.nagios.org/propaganda/books/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">书籍</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清单</font><font style="vertical-align: inherit;">：
          </font></font></p>
        </li>
<li class="list itemizedlist">
          <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><a href="https://help.ubuntu.com/community/Nagios3" class="ulink" title="https://help.ubuntu.com/community/Nagios3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nagios的Ubuntu的wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页面也有更多的细节。
          </font></font></p>
        </li>
</ul></div>
</div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="monitoring-overview.html" title="概观"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a><a class="nextlinks-next" href="munin.html" title="穆宁"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一页</font></font></a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文档中的资料可在免费许可下获得，</font><font style="vertical-align: inherit;">有关详细信息</font><font style="vertical-align: inherit;">，请参阅</font></font><a href="https://help.ubuntu.com/legal.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关贡献的信息，请参阅</font></font><a href="https://wiki.ubuntu.com/DocumentationTeam"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu文档团队Wiki页面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要报告此serverguide文档中</font></font><a href="https://bugs.launchpad.net/serverguide"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的错误</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请</font><a href="https://bugs.launchpad.net/serverguide"><font style="vertical-align: inherit;">提交错误报告</font></a><font style="vertical-align: inherit;">。</font></font></p></div>
</div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>